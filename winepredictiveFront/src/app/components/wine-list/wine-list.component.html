<p-toast [baseZIndex]="10000" [autoZIndex]="true" position="top-right" [life]="3000"></p-toast>


<!--Header-->
<div class="header">
    <div class="title-container">
        <h1>{{ user?.name }} Wine List</h1>
    </div>
    <p-button label="Create Wine" [rounded]="true" (onClick)="showDialog()" />
    <hr>
</div>
<hr>
<br><br>
<div class="table-container">

    <!--Table Body -->
<p-table [value]="wines"  class="table" [sortField]="'quality'" [sortOrder]="-1">

    <!-----------Table Rows-------------->
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="dateCreated" style="width:16%"  >
                Date of creation <p-sortIcon field="dateCreated" />
            </th>
            <th pSortableColumn="name" style="width:16%">
                Name <p-sortIcon field="name" />
            </th>
            <th pSortableColumn="quality" style="width:16%">
                Latest Quality Predicted <p-sortIcon field="quality" />
            </th>
            <th pSortableColumn="quantity" style="width:10%">
                Actions 
            </th>
        </tr>
    </ng-template>

    <!-------Table Columns-------->
    <ng-template pTemplate="body" let-wine>
        <tr>
            <td>{{ wine.dateCreated }}</td>
            <td>{{ wine.name }}</td>
            <td>
                @if(wine.quality){
                <p-rating [(ngModel)]="wine.quality" [cancel]="false" [stars]="8" [disabled]="true"></p-rating>
            }@else{
                <h4>No Data Predictions yet</h4>
            }
            </td>
            <!----------Buttons edit and delete----------->
            <td class="actions">
                <p-button label="Delete" [rounded]="true" severity="danger"  class="actions" (click)="deleteWine(wine.id)"/>
                <p-button label="Edit" [rounded]="true" severity="secondary" />
            </td>
        </tr>
    </ng-template>
</p-table>
</div>



<!----------------------Dialog to Create Wine-------------->
<p-dialog header="Create Wine" [draggable]="true" [resizable]="true" [modal]="true" [(visible)]="createWineDialogVisible" [style]="{ width: '25rem' }">
    <div class="flex align-items-center gap-3 mb-3">
        <p-floatLabel position="left">
            <input  type="text" pInputText  [(ngModel)] = "wineToSave.name"/>
            <label for="Wine Name">Wine name</label>
        </p-floatLabel>
    </div><br>
    <div class="flex align-items-center gap-3 mb-5">      
        <p-calendar [(ngModel)]="date" [disabled]="true"/>    
    </div><br>
    <div class="flex justify-content-end gap-2">
        <p-button label="Cancel" severity="secondary" (onClick)="createWineDialogVisible = false" />
        <p-button label="Save" (onClick)="createWine()" />
    </div>
</p-dialog>